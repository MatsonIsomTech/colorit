{% extends "colorit/_layouts/main" %}
{% import "_includes/forms" as forms %}

{% block content %}

 	<form action="" method="post" accept-charset="UTF-8">

        <input type="hidden" name="action" value="colorit/field-templates/save">

        {% if not isNewFieldTemplate %}
        	<input type="hidden" name="fieldTemplateId" value="{{ fieldTemplate.id }}">
            <input type="hidden" name="type" value="{{ fieldTemplate.type }}">
        {% endif %}

        {{ redirectInput('colorit/settings/fieldtemplates') }}
        {{ csrfInput() }}

        {{ forms.textField({
            label: 'Preset Name'|t('colorit'),
            instructions: 'What the preset will be called in the field creation.'|t('colorit'),
            id: 'name',
            name: 'name',
            placeholder: 'e.g. Brand Colors',
            value: fieldTemplate.name ?? '',
            errors: fieldTemplate.getErrors('name') ?? false,
            first: true
        }) }}

        {% if isNewFieldTemplate %}

            {% if allFieldTemplatesTypes|length > 1 %}

                {{ forms.selectField({
                    label: "Field Type"|t('app'),
                    instructions: "Which field do you want to create a template for?"|t('colorit'),
                    id: 'type',
                    name: 'type',
                    options: fieldTemplateTypeOptions,
                    value: fieldTemplate.type,
                    toggle: true
                }) }}

                <hr>

            {% else %}

                <input type="hidden" name="type" value="{{ allFieldTemplatesTypes[0] }}">

            {% endif %}

            {% for type in allFieldTemplatesTypes %}

                {% set isCurrent = fieldTemplate.type == type %}

                <div id="{{ type|id }}"{% if not isCurrent %} class="hidden"{% endif %}>

                    {% namespace 'types['~type~']' %}

                        {% set _fieldTemplate = isCurrent ? fieldTemplate : craft.colorit.fieldTemplates.createFieldTemplate(type) %}
                        {{ _fieldTemplate.getFieldSettingsHtml()|raw }}

                    {% endnamespace %}

                </div>

            {% endfor %}

        {% else %}

            {% namespace 'types['~fieldTemplate.type~']' %}

                {{ fieldTemplate.getFieldSettingsHtml()|raw }}

            {% endnamespace %}

        {% endif %}

        <div class="buttons">
            <input type="submit" class="btn submit" value="{{ 'Save'|t('colorit') }}">
        </div>

    </form>

{% endblock %}
